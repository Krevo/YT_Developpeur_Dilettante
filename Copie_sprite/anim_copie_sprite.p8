pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- animation copie de sprite 
-- et changement de couleur

-- global vars
posx = 0
posy = 0

spsrc = 0
spdst = 2
spw = 2 -- nb of base units (8 px)
sph = 3 -- nb of base units (8 px)
srccolor = 7 -- white
dstcolor = 10 -- yellow

-- 16 sprites per line
srcx = (spsrc % 16) * 8
srcy = (spsrc \ 16) * 8
dstx = (spdst % 16) * 8
dsty = (spdst \ 16) * 8

function _update()
	t = (time()*100)%5
	--if (t == 0) then
		posx += 1
		if (posx >= spw*8) then
			posx = 0
			posy += 1
			if (posy >= sph*8) then
				posx = 0
				posy = 0
			end
		end 
	--end
	rx = 10 + posx * 2
	ry = 15 + posy * 2

	dx = posx + (dstx-srcx)
	dy = posy + (dsty-srcy)

	srcc = sget(posx, posy)
	dstc = srcc
	if (srccolor != nil and dstcolor != nil and srcc == srccolor) then dstc = dstcolor end
	sset(posx + (dstx-srcx), posy + (dsty-srcy), dstc)

end

function _draw()
	cls()

	print("src :",5,5,7);
	sp = 0
	sx, sy = (sp % 16) * 8, (sp \ 16) * 8
	sspr(sx, sy, 16, 24, 10, 15, 32, 48)

	rect(rx-1,ry-1,rx+2,ry+2,8)

	print("dst :",5,70,7);
	sp = 2
	sx, sy = (sp % 16) * 8, (sp \ 16) * 8
	sspr(sx, sy, 16, 24, 10, 80, 32, 48)

	print("srcx = "..posx,60,40,7)
	print("srcy = "..posy,60,48,7)
	print("src color = ",60,56,7)
	rectfill(110,56,118,60,srcc)

	print("dstx = "..dx,60,70,7)
	print("dsty = "..dy,60,78,7)
	print("dst color = ",60,86,7)
	rectfill(110,86,118,90,dstc)

end
__gfx__
00007777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00777777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07777777777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
077777cc777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777c77cc7777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777c77777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777c77887777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
077777cc777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07777777777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07777777777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07077777777707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00707777777070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700777770070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00070077700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00070077700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007007007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007007007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000077700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
